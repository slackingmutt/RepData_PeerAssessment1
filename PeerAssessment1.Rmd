---
title: 'Reproducible Research: Peer Assessment 1'
author: "David Lingle"
date: "July 17, 2014"
output: html_document
---

### Load the data
It is assumed that the data file, *activity.csv*, will exist in the current  
working directory. The data will be be loaded by
```{r}
atv <- read.csv("./activity.csv")
```
First, let's do a preliminary review of the data.
```{r}
str(atv)
```
Let's examine the missing values.
```{r}
sum(is.na(atv))
sum(is.na(atv$steps))
```
From this we conclude that all of the missing values are in the 'steps' data.

### What is the mean total number of steps taken per day?

We have seen that the data for a day is distributed in 5 minutes intervals.  
In order to answer this question we must remove the NAs and organize the data 
by day. 
To do this we  
use the aggregate function.
```{r}
atv.nona <- na.omit(atv)
atv.day <- aggregate(atv.nona$steps,by=list(atv.nona$date),FUN=sum)
str(atv.day)
```
The histogram is

```{r}
hist(atv.day$x)
```

and the mean and median of the total steps taken per day are:  
- mean
```{r}
mean(atv.day$x)
```
- median
```{r}
median(atv.day$x)
```

### What is the average daily activity pattern?


### Imputing missing values

For each interval with a missing value a new value will be imputed by taking the 
average over all non-missing values for that interval.  This is accomplished though
the following function.
```{r}
imput <- function(active) {
        na.loc <- which(is.na(active$steps))
        na.mean <- c()

        for (ndx in 1:length(na.loc)){
             na.mean <- c(na.mean,
                          mean(
                                active[which(active$interval 
                                             == active$interval[na.loc[ndx]]),]$steps,
                                na.rm=T)
                        )
             active$steps[na.loc[ndx]] = na.mean[ndx]
        }
        return(active)
}

```

```{r}
atv.imput <- imput(atv)
sum(is.na(atv.imput))

```

And computing the mean and median:

```{r}
atv.imput.day <- aggregate(atv.imput$steps,by=list(atv.imput$date),FUN=sum)
hist(atv.imput.day$x)
```

The mean is:

```{r}
mean(atv.imput.day$x)
```

And the median is:

```{r}
median(atv.imput.day$x)
```
### Are there differences in activity patterns between weekdays and weekends?

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
